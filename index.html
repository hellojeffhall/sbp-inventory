<!doctype HTML>
<html>
<head>
  <title>Sample Title</title>
  <link rel="stylesheet" type="text/css" href="./style.css">
  <style>
    body {
      background-color: blue;
    }


</style>
</head>

<body>
This is a test of text. <h1>This</h1> is in h1.
  <script src="/socket.io/socket.io.js"></script>
  <script> 
    var socket = io();

    var submit_item = function(){
      var new_name = document.getElementById('item_name_field').value;
      var new_qty = document.getElementById('item_qty_field').value;
      var item_info = {"name" : new_name, "qty" : new_qty};
      socket.emit('request_newItem', item_info);
      document.getElementById('item_name_field').value = "";
      document.getElementById('item_qty_field').value = "";
    };

    var newRow = function(obj){
      var row = document.createElement('tr');

      var nameTd = document.createElement('td');
      nameTd.appendChild(document.createTextNode(obj.name));

      var qtyTd = document.createElement('td');
      qtyTd.appendChild(document.createTextNode(obj.qty));

      row.appendChild(nameTd);
      row.appendChild(qtyTd);
      
      console.log('row: ' + row);
      return (row);
    };

    socket.on('update_results', function(data){

      var headings = data.column_headings; // Array of column headings.
                                           // We should figure out how to have a display
                                           // name for each.
      var html_array_headings = '<tr>' +
        headings.map(function(temp_heading){
          return '<th>' + temp_heading + '</th>';
          }).join("") +
        '</tr>';

      var rows = data.rows;                // Array of rows to display.
                                           // Each row object should have a "column_name_db"
                                           // property as well as a "value" property.
                                           // This way, we know what to display
                                           // and under which column.

      var html_array = rows.map(function(temp_row){

        var this_row = headings.map(function(temp_heading){
          return '<td>' + temp_row[temp_heading] + '</td>';          
        });

        return '<tr>' +  this_row.join('') + '</tr>';
      });

      document.getElementById('results_table').innerHTML = html_array_headings + html_array.join('');
    });

  </script>

  <table id='results_table'>
  </table>

  <br><br><br>
  <input id="item_name_field" placeholder="Name"></input>
  <input id="item_qty_field" placeholder="Quantity"></input>
  <button onclick="submit_item()">Submit!</button>
</body>

</html>
